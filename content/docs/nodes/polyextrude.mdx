---
title: PolyExtrude
description: Extrude polygons and polylines with advanced options including inset, divisions, and curve support.
icon: Box
since: v1.0
versions: ['v1.0', 'v1.1', 'v1.2', 'v1.3']
---

import { Drawio } from 'components/mdx/drawio';
import { Lang } from 'components/mdx/lang';

<Lang lang="en">
# PolyExtrude

The **PolyExtrude Node** extrudes polygons and polylines along their normals, creating 3D geometry from 2D shapes. Version 1.3 introduces significant enhancements including **curve input support**, **inset control**, **divisions**, and flexible **output component management**.

## What's New in v1.3

- **Bezier Curve Support**: Automatically converts closed curves to polygons for extrusion
- **Inset Parameter**: Shrink or expand the extruded front face before extrusion
- **Divisions**: Create multi-segment extrusions with smooth side faces
- **Individual Element Mode**: Extrude each polygon independently without shared points
- **Selective Output**: Choose which components (front, back, sides) to generate

## Extrusion Modes

### Connected Components (Default)
Extrudes connected groups of polygons as unified shells, sharing points along connected edges. This produces manifold geometry suitable for further modeling operations.

### Individual Elements
Each selected polygon is extruded independently with no shared points between them. This is useful for:
- Creating arrays of separate objects
- Explosion effects
- Independent animation of elements

<Drawio file="content/docs/diagrams/polyextrude-modes.drawio" height={400} title="Connected vs Individual Extrusion Modes" />

## Parameters

### General

| Parameter | Type | Default | Description |
| :--- | :--- | :--- | :--- |
| **Group** | String | "" | Primitive group to extrude. Empty means all primitives. |
| **Divide Into** | Menu | Connected Components | Choose between **Connected Components** (shared points) or **Individual Elements** (separate). |

### Extrusion

| Parameter | Type | Default | Description |
| :--- | :--- | :--- | :--- |
| **Distance** | Float | 0.0 | How far to extrude along normals. Range: -10.0 to 10.0. |
| **Inset** | Float | 0.0 | Shrink (positive) or expand (negative) the front face before extrusion. Range: 0.0 to 5.0. |
| **Divisions** | Integer | 1 | Number of segments along the extrusion direction. Range: 1 to 10. |

### Output

| Parameter | Type | Default | Description |
| :--- | :--- | :--- | :--- |
| **Output Front** | Toggle | On | Generate the extruded front faces. |
| **Output Back** | Toggle | Off | Generate the back faces (original geometry). |
| **Output Side** | Toggle | On | Generate the side walls connecting front and back. |

### Groups

| Parameter | Type | Default | Description |
| :--- | :--- | :--- | :--- |
| **Front Group** | String | "extrudeFront" | Group name for front faces. |
| **Back Group** | String | "extrudeBack" | Group name for back faces. |
| **Side Group** | String | "extrudeSide" | Group name for side faces. |

## Curve Input Support (New in v1.3)

PolyExtrude now accepts **Bezier Curve** primitives as input. Closed curves are automatically resampled and converted to polygons before extrusion, preserving curve groups and attributes.

<Drawio file="content/docs/diagrams/polyextrude-curves.drawio" height={350} title="Curve to Polygon Conversion for Extrusion" />

**Supported Curve Types:**
- Closed Bezier Curves → Polygons (via resampling)
- Open Curves → Not extruded directly (convert to polyline first)

## Technical Details

### Normal Calculation

For **Connected Components** mode:
1. Accumulates face normals for each point from all selected polygons
2. Averages the normals for smooth extrusion direction
3. Falls back to zero if no valid normal can be computed

For **Individual Elements** mode:
1. Calculates per-polygon normal from vertex positions
2. Each polygon extrudes in its own direction

### Inset Algorithm

When inset is applied:
1. Calculate polygon centroid (center of vertices)
2. Offset each vertex toward/away from centroid by inset distance
3. Apply distance extrusion to the inset shape

### Side Face Generation

Side faces are generated by:
1. Identifying boundary half-edges using topology information
2. Creating quads connecting base points to front points
3. Supporting multi-division extrusions with interpolated rings

For polylines:
1. Each segment becomes a quad strip
2. Divisions create interpolated points along the extrusion

### Divisions Implementation

When divisions > 1:
1. Linearly interpolate between base and front positions
2. Create intermediate vertex rings
3. Connect rings with quad faces
4. Final ring connects to front face

```rust
// Pseudocode for division generation
for d in 1..=divisions {
    let t = d as f32 / divisions as f32;
    let pos_base = base_point;
    let pos_front = base_point + normal * distance;
    let pos_current = pos_base.lerp(pos_front, t);
    // Create vertices and faces...
}
```

## Output Structure

The node outputs a single geometry with:
- **Point Attributes**: `P` (position), `N` (flat normals calculated post-extrusion)
- **Primitive Groups**: Front/Back/Side groups as specified
- **Topology**: Full half-edge topology available for downstream nodes

## Use Cases

1. **Architectural Modeling**: Extrude floor plans with divisions for floor heights
2. **Logo/Text 3D**: Convert curves to 3D with precise inset control
3. **Mechanical Parts**: Create thickness from 2D profiles with back faces
4. **Voxel-like Arrays**: Use Individual Elements mode for blocky extrusions
5. **Beveled Extrusions**: Combine with PolyBevel for rounded edges

## Examples

### Basic Extrusion
```
Group: "" (all)
Distance: 2.0
Inset: 0.0
Output Front: On
Output Back: On
Output Side: On
```
Result: Solid 3D geometry with all faces.

### Inset Window Frame
```
Group: "window_shape"
Distance: 0.5
Inset: 0.1
Output Front: On
Output Back: Off
Output Side: On
```
Result: Window frame with inset front profile.

### Stacked Extrusion
```
Group: "floors"
Distance: 3.0
Divisions: 3
Output Front: On
Output Side: On
```
Result: Building with 3 floor divisions per extrusion.

### Curve to 3D
```
Input: Bezier Curve (closed)
Distance: 1.0
Inset: 0.0
```
Result: 3D extruded shape from curve profile.
</Lang>

<Lang lang="zh">
# 多边形挤出 (PolyExtrude)

**PolyExtrude 节点**沿法线方向挤出多边形和折线，从 2D 形状创建 3D 几何体。v1.3 版本引入了重大改进，包括**曲线输入支持**、**内缩控制**、**分段**和灵活的**输出组件管理**。

## v1.3 新特性

- **贝塞尔曲线支持**：自动将闭合曲线转换为多边形进行挤出
- **内缩参数**：在挤出前收缩或扩展挤出前面
- **分段**：创建多段挤出，带有平滑的侧面
- **独立元素模式**：独立挤出每个多边形，不共享点
- **选择性输出**：选择生成哪些组件（前面、背面、侧面）

## 挤出模式

### 连通组件（默认）
将连通的 polygon 组作为统一壳体挤出，沿连接边共享点。这产生适合进一步建模操作的流形几何体。

### 独立元素
每个选中的多边形独立挤出，之间不共享点。这适用于：
- 创建独立对象的阵列
- 爆炸效果
- 元素的独立动画

<Drawio file="content/docs/diagrams/polyextrude-modes.drawio" height={400} title="连通组件与独立挤出模式对比" />

## 参数

### 通用

| 参数名 | 类型 | 默认值 | 描述 |
| :--- | :--- | :--- | :--- |
| **Group（组）** | 字符串 | "" | 要挤出的图元组。空表示所有图元。 |
| **Divide Into（分割为）** | 菜单 | Connected Components | 选择**连通组件**（共享点）或**独立元素**（分离）。 |

### 挤出

| 参数名 | 类型 | 默认值 | 描述 |
| :--- | :--- | :--- | :--- |
| **Distance（距离）** | 浮点数 | 0.0 | 沿法线挤出的距离。范围：-10.0 到 10.0。 |
| **Inset（内缩）** | 浮点数 | 0.0 | 在挤出前收缩（正值）或扩展（负值）前面。范围：0.0 到 5.0。 |
| **Divisions（分段）** | 整数 | 1 | 沿挤出方向的分段数。范围：1 到 10。 |

### 输出

| 参数名 | 类型 | 默认值 | 描述 |
| :--- | :--- | :--- | :--- |
| **Output Front（输出前面）** | 开关 | 开 | 生成挤出的前面。 |
| **Output Back（输出背面）** | 开关 | 关 | 生成背面（原始几何体）。 |
| **Output Side（输出侧面）** | 开关 | 开 | 生成连接前面和背面的侧壁。 |

### 组

| 参数名 | 类型 | 默认值 | 描述 |
| :--- | :--- | :--- | :--- |
| **Front Group（前面组）** | 字符串 | "extrudeFront" | 前面组的名称。 |
| **Back Group（背面组）** | 字符串 | "extrudeBack" | 背面组的名称。 |
| **Side Group（侧面组）** | 字符串 | "extrudeSide" | 侧面组的名称。 |

## 曲线输入支持（v1.3 新增）

PolyExtrude 现在接受**贝塞尔曲线**图元作为输入。闭合曲线在挤出前自动重采样并转换为多边形，保留曲线组和属性。

<Drawio file="content/docs/diagrams/polyextrude-curves.drawio" height={350} title="曲线到多边形转换用于挤出" />

**支持的曲线类型：**
- 闭合贝塞尔曲线 → 多边形（通过重采样）
- 开放曲线 → 不直接挤出（先转换为折线）

## 技术细节

### 法线计算

**连通组件**模式：
1. 从所有选中的多边形为每个点累积面法线
2. 平均法线以获得平滑的挤出方向
3. 如果无法计算有效法线则回退到零

**独立元素**模式：
1. 从顶点位置计算每个多边形的法线
2. 每个多边形沿自己的方向挤出

### 内缩算法

应用内缩时：
1. 计算多边形质心（顶点中心）
2. 按内缩距离将每个顶点向/远离质心偏移
3. 对偏移后的形状应用距离挤出

### 侧面生成

侧面通过以下方式生成：
1. 使用拓扑信息识别边界半边
2. 创建连接基点到前点的四边形
3. 支持多分段挤出，带有插值环

对于折线：
1. 每个线段成为四边形条带
2. 分段沿挤出方向创建插值点

### 分段实现

当分段数 > 1 时：
1. 在基点和前点之间线性插值
2. 创建中间顶点环
3. 用四边形面连接各环
4. 最后一环连接到前面

```rust
// 分段生成的伪代码
for d in 1..=divisions {
    let t = d as f32 / divisions as f32;
    let pos_base = base_point;
    let pos_front = base_point + normal * distance;
    let pos_current = pos_base.lerp(pos_front, t);
    // 创建顶点和面...
}
```

## 输出结构

节点输出单个几何体，包含：
- **点属性**：`P`（位置）、`N`（挤出后计算的平面法线）
- **图元组**：指定的前面/背面/侧面组
- **拓扑**：完整的半边拓扑，可供下游节点使用

## 应用场景

1. **建筑建模**：按楼层高度分段挤出平面图
2. **Logo/文字 3D**：通过精确的内缩控制将曲线转为 3D
3. **机械零件**：从 2D 轮廓创建带背面的厚度
4. **类体素阵列**：使用独立元素模式进行块状挤出
5. **倒角挤出**：与 PolyBevel 结合创建圆边

## 示例

### 基础挤出
```
Group: "" (全部)
Distance: 2.0
Inset: 0.0
Output Front: On
Output Back: On
Output Side: On
```
结果：包含所有面的实体 3D 几何体。

### 内缩窗框
```
Group: "window_shape"
Distance: 0.5
Inset: 0.1
Output Front: On
Output Back: Off
Output Side: On
```
结果：带内缩前面轮廓的窗框。

### 堆叠挤出
```
Group: "floors"
Distance: 3.0
Divisions: 3
Output Front: On
Output Side: On
```
结果：每次挤出有 3 层楼分段的建筑。

### 曲线转 3D
```
Input: Bezier Curve (closed)
Distance: 1.0
Inset: 0.0
```
结果：从曲线轮廓挤出的 3D 形状。
</Lang>
